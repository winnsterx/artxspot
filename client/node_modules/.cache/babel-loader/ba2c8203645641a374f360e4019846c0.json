{"ast":null,"code":"import _regeneratorRuntime from\"/Users/winker.xiao/webapps/metspot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/winker.xiao/webapps/metspot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/winker.xiao/webapps/metspot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Card,Row,Col}from\"antd\";import SpotifyWebApi from\"spotify-web-api-js\";import Generator from\"./Generator\";var spotifyApi=new SpotifyWebApi();function Playlists(_ref){var token=_ref.token;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),playlists=_useState2[0],setPlaylists=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),tracks=_useState4[0],setTracks=_useState4[1];useEffect(function(){if(!Object.keys(playlists).length){getPlaylists();}});function getPlaylists(){return _getPlaylists.apply(this,arguments);}function _getPlaylists(){_getPlaylists=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var pls;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:spotifyApi.setAccessToken(token);_context.next=3;return getPlaylistsHelper();case 3:pls=_context.sent;if(pls){setPlaylists(pls.items);}else{console.log(\"Error in fetching playlists. Check request in Spotify API.\");}case 5:case\"end\":return _context.stop();}}},_callee);}));return _getPlaylists.apply(this,arguments);}function getPlaylistsHelper(){return _getPlaylistsHelper.apply(this,arguments);}function _getPlaylistsHelper(){_getPlaylistsHelper=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return spotifyApi.getUserPlaylists();case 3:return _context2.abrupt(\"return\",_context2.sent);case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",null);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return _getPlaylistsHelper.apply(this,arguments);}function selectPlaylist(_x){return _selectPlaylist.apply(this,arguments);}function _selectPlaylist(){_selectPlaylist=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(playlist){var tracks;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getPlaylistTracks(playlist.id);case 2:tracks=_context3.sent;if(tracks){setTracks(tracks);}else{console.log(\"Error in fetching playlist's tracks. Check request in Spotify API.\");}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _selectPlaylist.apply(this,arguments);}function getPlaylistTracks(_x2){return _getPlaylistTracks.apply(this,arguments);}function _getPlaylistTracks(){_getPlaylistTracks=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return spotifyApi.getPlaylistTracks(id);case 3:return _context4.abrupt(\"return\",_context4.sent);case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](0);return _context4.abrupt(\"return\",null);case 9:case\"end\":return _context4.stop();}}},_callee4,null,[[0,6]]);}));return _getPlaylistTracks.apply(this,arguments);}function buildPlaylists(){var arr=[];var _loop=function _loop(i){var curr=playlists[i];arr.push(/*#__PURE__*/React.createElement(Col,{span:8},/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){return selectPlaylist(curr);}},/*#__PURE__*/React.createElement(Card,{size:\"small\",title:curr.name,hoverable:true,cover:/*#__PURE__*/React.createElement(\"img\",{alt:\"example\",src:curr.images[0].url})}))));};for(var i=0;i<playlists.length;i++){_loop(i);}return arr;}return/*#__PURE__*/React.createElement(\"div\",{className:\"page\"},tracks.length===0?/*#__PURE__*/React.createElement(Row,{gutter:16},\" \",buildPlaylists()):/*#__PURE__*/React.createElement(Generator,{tracks:tracks}));}export default Playlists;","map":{"version":3,"sources":["/Users/winker.xiao/webapps/metspot/src/components/Playlists.js"],"names":["React","useState","useEffect","Card","Row","Col","SpotifyWebApi","Generator","spotifyApi","Playlists","token","playlists","setPlaylists","tracks","setTracks","Object","keys","length","getPlaylists","setAccessToken","getPlaylistsHelper","pls","items","console","log","getUserPlaylists","selectPlaylist","playlist","getPlaylistTracks","id","buildPlaylists","arr","i","curr","push","name","images","url"],"mappings":"wcAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,IAAT,CAAeC,GAAf,CAAoBC,GAApB,KAA+B,MAA/B,CAEA,MAAOC,CAAAA,aAAP,KAA0B,oBAA1B,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CAEA,GAAMC,CAAAA,UAAU,CAAG,GAAIF,CAAAA,aAAJ,EAAnB,CAEA,QAASG,CAAAA,SAAT,MAA8B,IAATC,CAAAA,KAAS,MAATA,KAAS,eACMT,QAAQ,CAAC,EAAD,CADd,wCACrBU,SADqB,eACVC,YADU,8BAEAX,QAAQ,CAAC,EAAD,CAFR,yCAErBY,MAFqB,eAEbC,SAFa,eAI5BZ,SAAS,CAAC,UAAM,CACd,GAAI,CAACa,MAAM,CAACC,IAAP,CAAYL,SAAZ,EAAuBM,MAA5B,CAAoC,CAClCC,YAAY,GACb,CACF,CAJQ,CAAT,CAJ4B,QAUbA,CAAAA,YAVa,8IAU5B,2IACEV,UAAU,CAACW,cAAX,CAA0BT,KAA1B,EADF,sBAEkBU,CAAAA,kBAAkB,EAFpC,QAEMC,GAFN,eAGE,GAAIA,GAAJ,CAAS,CACPT,YAAY,CAACS,GAAG,CAACC,KAAL,CAAZ,CACD,CAFD,IAEO,CACLC,OAAO,CAACC,GAAR,CAAY,4DAAZ,EACD,CAPH,sDAV4B,uDAoBbJ,CAAAA,kBApBa,gKAoB5B,gLAEiBZ,CAAAA,UAAU,CAACiB,gBAAX,EAFjB,qJAIW,IAJX,uEApB4B,6DA4BbC,CAAAA,cA5Ba,sJA4B5B,kBAA8BC,QAA9B,wJACqBC,CAAAA,iBAAiB,CAACD,QAAQ,CAACE,EAAV,CADtC,QACMhB,MADN,gBAEE,GAAIA,MAAJ,CAAY,CACVC,SAAS,CAACD,MAAD,CAAT,CACD,CAFD,IAEO,CACLU,OAAO,CAACC,GAAR,CACE,oEADF,EAGD,CARH,wDA5B4B,yDAuCbI,CAAAA,iBAvCa,gKAuC5B,kBAAiCC,EAAjC,8JAEiBrB,CAAAA,UAAU,CAACoB,iBAAX,CAA6BC,EAA7B,CAFjB,qJAIW,IAJX,uEAvC4B,oDA+C5B,QAASC,CAAAA,cAAT,EAA0B,CACxB,GAAIC,CAAAA,GAAG,CAAG,EAAV,CADwB,yBAEfC,CAFe,EAGtB,GAAIC,CAAAA,IAAI,CAAGtB,SAAS,CAACqB,CAAD,CAApB,CACAD,GAAG,CAACG,IAAJ,cACE,oBAAC,GAAD,EAAK,IAAI,CAAE,CAAX,eACE,2BAAK,OAAO,CAAE,yBAAMR,CAAAA,cAAc,CAACO,IAAD,CAApB,EAAd,eACE,oBAAC,IAAD,EACE,IAAI,CAAC,OADP,CAEE,KAAK,CAAEA,IAAI,CAACE,IAFd,CAGE,SAAS,KAHX,CAIE,KAAK,cAAE,2BAAK,GAAG,CAAC,SAAT,CAAmB,GAAG,CAAEF,IAAI,CAACG,MAAL,CAAY,CAAZ,EAAeC,GAAvC,EAJT,EADF,CADF,CADF,EAJsB,EAExB,IAAK,GAAIL,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGrB,SAAS,CAACM,MAA9B,CAAsCe,CAAC,EAAvC,CAA2C,OAAlCA,CAAkC,EAc1C,CACD,MAAOD,CAAAA,GAAP,CACD,CAED,mBACE,2BAAK,SAAS,CAAC,MAAf,EACGlB,MAAM,CAACI,MAAP,GAAkB,CAAlB,cACC,oBAAC,GAAD,EAAK,MAAM,CAAE,EAAb,MAAmBa,cAAc,EAAjC,CADD,cAGC,oBAAC,SAAD,EAAW,MAAM,CAAEjB,MAAnB,EAJJ,CADF,CASD,CAED,cAAeJ,CAAAA,SAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Card, Row, Col } from \"antd\";\n\nimport SpotifyWebApi from \"spotify-web-api-js\";\nimport Generator from \"./Generator\";\n\nconst spotifyApi = new SpotifyWebApi();\n\nfunction Playlists({ token }) {\n  const [playlists, setPlaylists] = useState({});\n  const [tracks, setTracks] = useState([]);\n\n  useEffect(() => {\n    if (!Object.keys(playlists).length) {\n      getPlaylists();\n    }\n  });\n\n  async function getPlaylists() {\n    spotifyApi.setAccessToken(token);\n    let pls = await getPlaylistsHelper();\n    if (pls) {\n      setPlaylists(pls.items);\n    } else {\n      console.log(\"Error in fetching playlists. Check request in Spotify API.\");\n    }\n  }\n\n  async function getPlaylistsHelper() {\n    try {\n      return await spotifyApi.getUserPlaylists();\n    } catch (error) {\n      return null;\n    }\n  }\n\n  async function selectPlaylist(playlist) {\n    let tracks = await getPlaylistTracks(playlist.id);\n    if (tracks) {\n      setTracks(tracks);\n    } else {\n      console.log(\n        \"Error in fetching playlist's tracks. Check request in Spotify API.\"\n      );\n    }\n  }\n\n  async function getPlaylistTracks(id) {\n    try {\n      return await spotifyApi.getPlaylistTracks(id);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  function buildPlaylists() {\n    let arr = [];\n    for (let i = 0; i < playlists.length; i++) {\n      let curr = playlists[i];\n      arr.push(\n        <Col span={8}>\n          <div onClick={() => selectPlaylist(curr)}>\n            <Card\n              size=\"small\"\n              title={curr.name}\n              hoverable\n              cover={<img alt=\"example\" src={curr.images[0].url} />}\n            ></Card>\n          </div>\n        </Col>\n      );\n    }\n    return arr;\n  }\n\n  return (\n    <div className=\"page\">\n      {tracks.length === 0 ? (\n        <Row gutter={16}> {buildPlaylists()}</Row>\n      ) : (\n        <Generator tracks={tracks} />\n      )}\n    </div>\n  );\n}\n\nexport default Playlists;\n"]},"metadata":{},"sourceType":"module"}